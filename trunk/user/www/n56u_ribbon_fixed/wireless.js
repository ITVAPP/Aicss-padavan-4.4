var wep1,wep2,wep3,wep4;function automode_hint(){var e=document.form.wl_gmode.value;"2"!=e&&"3"!=e&&"4"!=e&&"5"!=e||1!=document.form.wl_wep_x.value&&2!=document.form.wl_wep_x.value&&"radius"!=document.form.wl_auth_mode.value&&(0!=document.form.wl_crypto.value.indexOf("tkip")||document.form.wl_crypto.disabled)?$("wl_gmode_hint").style.display="none":$("wl_gmode_hint").style.display="block"}function nmode_limitation(){var e=document.form.wl_gmode.value;"1"!=e&&"3"!=e||(0!=document.form.wl_auth_mode.selectedIndex||"1"!=document.form.wl_wep_x.selectedIndex&&"2"!=document.form.wl_wep_x.selectedIndex?1==document.form.wl_auth_mode.selectedIndex||2==document.form.wl_auth_mode.selectedIndex?(alert("<#WLANConfig11n_nmode_limition_hint#>"),document.form.wl_auth_mode.selectedIndex=3,document.form.wl_wpa_mode.value=2):5==document.form.wl_auth_mode.selectedIndex?(alert("<#WLANConfig11n_nmode_limition_hint#>"),document.form.wl_auth_mode.selectedIndex=6):7!=document.form.wl_auth_mode.selectedIndex||0!=document.form.wl_crypto.selectedIndex&&2!=document.form.wl_crypto.selectedIndex||(alert("<#WLANConfig11n_nmode_limition_hint#>"),document.form.wl_crypto.selectedIndex=1):(alert("<#WLANConfig11n_nmode_limition_hint#>"),document.form.wl_auth_mode.selectedIndex=0,document.form.wl_wep_x.selectedIndex=0),wl_auth_mode_change(0))}function change_common_wl(o,s,v){if(change=1,pageChanged=1,"wl_auth_mode"==v)wl_auth_mode_change(0),"psk"==o.value||"wpa"==o.value?(opts=document.form.wl_auth_mode.options,"WPA-Personal"==opts[opts.selectedIndex].text?(document.form.wl_wpa_mode.value="1",automode_hint()):"WPA2-Personal"==opts[opts.selectedIndex].text?document.form.wl_wpa_mode.value="2":"WPA-Auto-Personal"==opts[opts.selectedIndex].text?document.form.wl_wpa_mode.value="0":"WPA-Enterprise"==opts[opts.selectedIndex].text?document.form.wl_wpa_mode.value="3":"WPA-Auto-Enterprise"==opts[opts.selectedIndex].text&&(document.form.wl_wpa_mode.value="4"),"psk"==o.value&&(document.form.wl_wpa_psk.focus(),document.form.wl_wpa_psk.select())):"shared"==o.value&&(document.form.wl_key1.focus(),document.form.wl_key1.select()),nmode_limitation(),automode_hint();else if("wl_crypto"==v)wl_auth_mode_change(0),nmode_limitation(),automode_hint();else if("wl_wep_x"==v)change_wlweptype(o,"WLANConfig11a"),nmode_limitation(),automode_hint();else if("wl_key"==v){var selected_key=eval("document.form.wl_key"+o.value);selected_key.focus(),selected_key.select()}else"wl_country_code"==v?(insertChannelOption(),insertExtChannelOption()):"wl_channel"==v||"wl_HT_BW"==v?insertExtChannelOption():"wl_gmode"==v?(enableExtChRows(o),insertExtChannelOption(),nmode_limitation(),automode_hint()):"wl_guest_auth_mode_1"==v?(wl_auth_mode_change_guest(0),"psk"==o.value?(document.form.wl_guest_wpa_psk_1.focus(),document.form.wl_guest_wpa_psk_1.select()):"shared"!=o.value&&"radius"!=o.value||(document.form.wl_guest_phrase_x_1.focus(),document.form.wl_guest_phrase_x_1.select())):"wl_guest_wep_x_1"==v?change_wlweptype_guest(o,"WLANConfig11a"):"wl_guest_crypto_1"==v&&wl_auth_mode_change_guest(0);return!0}function change_wlweptype(e,t,o){var n;"0"==e.value?(n=0,document.form.wl_key1.value="",document.form.wl_key2.value="",document.form.wl_key3.value="",document.form.wl_key4.value=""):(n=1,document.form.wl_phrase_x.value.length>0&&0==o&&is_wlphrase("WLANConfig11a","wl_phrase_x",document.form.wl_phrase_x)),inputCtrl(document.form.wl_phrase_x,n),inputCtrl(document.form.wl_key1,n),inputCtrl(document.form.wl_key2,n),inputCtrl(document.form.wl_key3,n),inputCtrl(document.form.wl_key4,n),inputCtrl(document.form.wl_key,n),wl_wep_change()}function change_wlkey(e,t){var o;return"1"==(o="Advanced_WirelessGuest_Content.asp"==document.form.current_page.value?document.form.wl_guest_wep_x_1.value:document.form.wl_wep_x.value)?e.value.length>10&&(e.value=e.value.substring(0,10)):"2"==o&&e.value.length>26&&(e.value=e.value.substring(0,26)),!0}function changeWEPType(){var e;e="0"==document.form.wl_wep.value?0:1,inputCtrl(document.form.wl_phrase_x,e),inputCtrl(document.form.wl_key1,e),inputCtrl(document.form.wl_key2,e),inputCtrl(document.form.wl_key3,e),inputCtrl(document.form.wl_key4,e),inputCtrl(document.form.wl_key,e)}function changeAuthType(){"shared"==document.form.wl_auth_mode.value?(inputCtrl(document.form.wl_crypto,0),inputCtrl(document.form.wl_wpa_psk,0),inputCtrl(document.form.wl_wep,1),inputCtrl(document.form.wl_phrase_x,1),inputCtrl(document.form.wl_key1,1),inputCtrl(document.form.wl_key2,1),inputCtrl(document.form.wl_key3,1),inputCtrl(document.form.wl_key4,1),inputCtrl(document.form.wl_key,1),inputCtrl(document.form.wl_wpa_gtk_rekey,0)):"psk"==document.form.wl_auth_mode.value?(inputCtrl(document.form.wl_crypto,1),inputCtrl(document.form.wl_wpa_psk,1),inputCtrl(document.form.wl_wep,1),inputCtrl(document.form.wl_phrase_x,1),inputCtrl(document.form.wl_key1,1),inputCtrl(document.form.wl_key2,1),inputCtrl(document.form.wl_key3,1),inputCtrl(document.form.wl_key4,1),inputCtrl(document.form.wl_key,1),inputCtrl(document.form.wl_wpa_gtk_rekey,0)):"wpa"==document.form.wl_auth_mode.value?(inputCtrl(document.form.wl_crypto,0),inputCtrl(document.form.wl_wpa_psk,0),inputCtrl(document.form.wl_wep,0),inputCtrl(document.form.wl_phrase_x,0),inputCtrl(document.form.wl_key1,0),inputCtrl(document.form.wl_key2,0),inputCtrl(document.form.wl_key3,0),inputCtrl(document.form.wl_key4,0),inputCtrl(document.form.wl_key,0),inputCtrl(document.form.wl_wpa_gtk_rekey,0)):"radius"==document.form.wl_auth_mode.value?(inputCtrl(document.form.wl_crypto,1),inputCtrl(document.form.wl_wpa_psk,1),inputCtrl(document.form.wl_wep,1),inputCtrl(document.form.wl_phrase_x,1),inputCtrl(document.form.wl_key1,1),inputCtrl(document.form.wl_key2,1),inputCtrl(document.form.wl_key3,1),inputCtrl(document.form.wl_key4,1),inputCtrl(document.form.wl_key,1),inputCtrl(document.form.wl_wpa_gtk_rekey,0)):(inputCtrl(document.form.wl_crypto,0),inputCtrl(document.form.wl_wpa_psk,0),inputCtrl(document.form.wl_wep,1),inputCtrl(document.form.wl_phrase_x,1),inputCtrl(document.form.wl_key1,1),inputCtrl(document.form.wl_key1,1),inputCtrl(document.form.wl_key1,1),inputCtrl(document.form.wl_key1,1),inputCtrl(document.form.wl_key1,1),inputCtrl(document.form.wl_key,1),inputCtrl(document.form.wl_wpa_gtk_rekey,0))}function is_wlphrase(e,t,o){var n=new Array,r=new Array(5);if("wl_wpa_psk"==t)return valid_WPAPSK(o);if("Advanced_WirelessGuest_Content.asp"==document.form.current_page.value?(wepType=document.form.wl_guest_wep_x_1.value,wepKey1=document.form.wl_guest_key1_1,wepKey2=document.form.wl_guest_key2_1,wepKey3=document.form.wl_guest_key3_1,wepKey4=document.form.wl_guest_key4_1):(wepType=document.form.wl_wep_x.value,wepKey1=document.form.wl_key1,wepKey2=document.form.wl_key2,wepKey3=document.form.wl_key3,wepKey4=document.form.wl_key4),phrase=o.value,"1"==wepType){for(var l=0;l<phrase.length;l++)n[l%4]^=phrase.charCodeAt(l);randNumber=n[0]|n[1]<<8|n[2]<<16|n[3]<<24;for(var u=0;u<5;u++)randNumber=214013*randNumber%16777216,randNumber=(randNumber+2531011)%16777216,r[u]=randNumber>>16&255;wepKey1.value=binl2hex_c(r);for(u=0;u<5;u++)randNumber=214013*randNumber%16777216,randNumber=(randNumber+2531011)%16777216,r[u]=randNumber>>16&255;wepKey2.value=binl2hex_c(r);for(u=0;u<5;u++)randNumber=214013*randNumber%16777216,randNumber=(randNumber+2531011)%16777216,r[u]=randNumber>>16&255;wepKey3.value=binl2hex_c(r);for(u=0;u<5;u++)randNumber=214013*randNumber%16777216,randNumber=(randNumber+2531011)%16777216,r[u]=randNumber>>16&255;wepKey4.value=binl2hex_c(r)}else if("2"==wepType||"3"==wepType){if(password="",phrase.length>0)for(l=0;l<64;l++)ch=phrase.charAt(l%phrase.length),password+=ch;password=calcMD5(password),"2"==wepType?wepKey1.value=password.substr(0,26):wepKey1.value=password.substr(0,32),wepKey2.value=wepKey1.value,wepKey3.value=wepKey1.value,wepKey4.value=wepKey1.value}return!0}function wl_wep_change(){var e=document.form.wl_auth_mode.value,t=document.form.wl_wep_x.value;"psk"==e||"wpa"==e||"wpa2"==e?("wpa"!=e&&"wpa2"!=e&&(inputCtrl(document.form.wl_crypto,1),inputCtrl(document.form.wl_wpa_psk,1)),inputCtrl(document.form.wl_wpa_gtk_rekey,1),inputCtrl(document.form.wl_wep_x,0),inputCtrl(document.form.wl_phrase_x,0),inputCtrl(document.form.wl_key1,0),inputCtrl(document.form.wl_key2,0),inputCtrl(document.form.wl_key3,0),inputCtrl(document.form.wl_key4,0),inputCtrl(document.form.wl_key,0),$("row_wpa3").style.display="",$("row_wep1").style.display="none",$("row_wep2").style.display="none",$("row_wep3").style.display="none",$("row_wep4").style.display="none",$("row_wep5").style.display="none",$("row_wep6").style.display="none",$("row_wep7").style.display="none"):"radius"==e?(inputCtrl(document.form.wl_crypto,0),inputCtrl(document.form.wl_wpa_psk,0),inputCtrl(document.form.wl_wpa_gtk_rekey,0),inputCtrl(document.form.wl_wep_x,0),inputCtrl(document.form.wl_phrase_x,0),inputCtrl(document.form.wl_key1,0),inputCtrl(document.form.wl_key2,0),inputCtrl(document.form.wl_key3,0),inputCtrl(document.form.wl_key4,0),inputCtrl(document.form.wl_key,0),$("row_wpa3").style.display="none",$("row_wep1").style.display="none",$("row_wep2").style.display="none",$("row_wep3").style.display="none",$("row_wep4").style.display="none",$("row_wep5").style.display="none",$("row_wep6").style.display="none",$("row_wep7").style.display="none"):(inputCtrl(document.form.wl_crypto,0),inputCtrl(document.form.wl_wpa_psk,0),inputCtrl(document.form.wl_wpa_gtk_rekey,0),inputCtrl(document.form.wl_wep_x,1),$("row_wpa3").style.display="none",$("row_wep1").style.display="","0"!=t?(inputCtrl(document.form.wl_phrase_x,1),inputCtrl(document.form.wl_key1,1),inputCtrl(document.form.wl_key2,1),inputCtrl(document.form.wl_key3,1),inputCtrl(document.form.wl_key4,1),inputCtrl(document.form.wl_key,1),$("row_wep2").style.display="",$("row_wep3").style.display="",$("row_wep4").style.display="",$("row_wep5").style.display="",$("row_wep6").style.display="",$("row_wep7").style.display=""):(inputCtrl(document.form.wl_phrase_x,0),inputCtrl(document.form.wl_key1,0),inputCtrl(document.form.wl_key2,0),inputCtrl(document.form.wl_key3,0),inputCtrl(document.form.wl_key4,0),inputCtrl(document.form.wl_key,0),$("row_wep2").style.display="none",$("row_wep3").style.display="none",$("row_wep4").style.display="none",$("row_wep5").style.display="none",$("row_wep6").style.display="none",$("row_wep7").style.display="none")),change_key_des()}function change_wep_type(e,t){var o,n,r=document.form.wl_wep_x.value;free_options(document.form.wl_wep_x),"shared"==e?(o=new Array("WEP-64bits","WEP-128bits"),n=new Array("1","2")):(o=new Array("None","WEP-64bits","WEP-128bits"),n=new Array("0","1","2")),add_options_x2(document.form.wl_wep_x,o,n,r),"psk"!=e&&"wpa"!=e&&"wpa2"!=e&&"radius"!=e||(document.form.wl_wep_x.value="0"),change_wlweptype(document.form.wl_wep_x,"WLANConfig11a",t)}function enableExtChRows(e){"0"==e.value?($("row_HT_BW").style.display="none",$("row_HT_EXTCHA").style.display="none"):($("row_HT_BW").style.display="",$("row_HT_EXTCHA").style.display=""),"3"==e.value||"4"==e.value||"5"==e.value?insert_vht_bw(1):insert_vht_bw(0)}function insertChannelOption(){var e,t=document.form.wl_country_code.value,o=document.form.wl_channel.value;free_options(document.form.wl_channel),e="AL"==t||"DZ"==t||"AU"==t||"BH"==t||"CA"==t||"CL"==t||"CO"==t||"CR"==t||"DO"==t||"SV"==t||"GT"==t||"HN"==t||"HK"==t||"IN"==t||"IL"==t||"JO"==t||"KZ"==t||"LB"==t||"MO"==t||"MK"==t||"MY"==t||"MX"==t||"NZ"==t||"NO"==t||"OM"==t||"PK"==t||"PA"==t||"PR"==t||"QA"==t||"CN"==t||"RO"==t||"SA"==t||"SG"==t||"SY"==t||"TH"==t||"AE"==t||"US"==t||"VN"==t||"YE"==t||"ZW"==t?new Array(0,36,40,44,48,52,56,60,64,149,153,157,161,165):"AT"==t||"BE"==t||"BR"==t||"BG"==t||"CY"==t||"DK"==t||"EE"==t||"FI"==t||"DE"==t||"GR"==t||"HU"==t||"IS"==t||"IE"==t||"IT"==t||"LV"==t||"LI"==t||"LT"==t||"LU"==t||"NL"==t||"PL"==t||"PT"==t||"SK"==t||"SI"==t||"ZA"==t||"ES"==t||"SE"==t||"CH"==t||"GB"==t||"UZ"==t?new Array(0,36,40,44,48,52,56,60,64,100,104,108,112,116,120,124,128,132,136,140):"AM"==t||"AZ"==t||"HR"==t||"CZ"==t||"EG"==t||"FR"==t||"GE"==t||"MC"==t||"TT"==t||"TN"==t||"TR"==t?new Array(0,36,40,44,48,52,56,60,64):"AR"==t||"TW"==t?new Array(0,52,56,60,64,149,153,157):"BZ"==t||"BO"==t||"BN"==t||"ID"==t||"IR"==t||"PE"==t||"PH"==t?new Array(0,149,153,157,161,165):"KP"==t||"KR"==t||"UY"==t||"VE"==t?new Array(0,149,153,157,161):"JP"==t?new Array(0,36,40,44,48,52,56,60,64,100,104,108,112,116,132,136,140,149,153,157,161,165):"BY"==t?new Array(0,36,40,44,48,52,56,60,64,132,136,140,144):"UA"==t?new Array(0,36,40,44,48,52,56,60,64,100,104,108,112,116,120,124,128,132,136,140,149,153,157,161,165):"RU"==t?new Array(0,36,40,44,48,52,56,60,64,132,136,140,144,149,153,157,161,165):new Array(0,36,40,44,48,52,56,60,64,100,104,108,112,116,120,124,128,132,136,140,149,153,157,161,165);for(var n=new Array,r=0;r<e.length;r++)n[r]=e[r];"0"==n[0]&&(e[0]="<#APChnAuto#>"),add_options_x2(document.form.wl_channel,e,n,o)}function insertExtChannelOption(){}function insert_vht_bw(e){var t=document.form.wl_HT_BW,o=t.value,n=t.options.length;if(e){if(n>2)return;t.options[2]=new Option("20/40/80 MHz"),t.options[2].value="2"}else{if(n<3)return;t.remove(2),"2"==o&&(t.options[1].selected=1)}}function wl_auth_mode_change(e){var t,o,n=document.form.wl_auth_mode.value;if(inputCtrl(document.form.wl_wep_x,1),"wpa"==n||"wpa2"==n||"psk"==n?(inputCtrl(document.form.wl_crypto,1),$("row_wpa1").style.display=""):(inputCtrl(document.form.wl_crypto,0),$("row_wpa1").style.display="none"),"psk"==n?(inputCtrl(document.form.wl_wpa_psk,1),$("row_wpa2").style.display=""):(inputCtrl(document.form.wl_wpa_psk,0),$("row_wpa2").style.display="none"),"psk"==n){for(var r=0;r<document.form.wl_crypto.length;r++)if(document.form.wl_crypto[r].selected){t=document.form.wl_crypto[r].value;break}for(var r in opts=document.form.wl_auth_mode.options,o="WPA-Personal"==opts[opts.selectedIndex].text?new Array("TKIP"):"WPA2-Personal"==opts[opts.selectedIndex].text?new Array("AES"):new Array("AES","TKIP+AES"),document.form.wl_crypto.length=o.length,o)document.form.wl_crypto[r]=new Option(o[r],o[r].toLowerCase()),document.form.wl_crypto[r].value=o[r].toLowerCase(),o[r].toLowerCase()==t&&(document.form.wl_crypto[r].selected=!0)}else if("wpa"==n){for(r=0;r<document.form.wl_crypto.length;r++)if(document.form.wl_crypto[r].selected){t=document.form.wl_crypto[r].value;break}for(var r in opts=document.form.wl_auth_mode.options,o="WPA-Enterprise"==opts[opts.selectedIndex].text?new Array("TKIP"):new Array("AES","TKIP+AES"),document.form.wl_crypto.length=o.length,o)document.form.wl_crypto[r]=new Option(o[r],o[r].toLowerCase()),document.form.wl_crypto[r].value=o[r].toLowerCase(),o[r].toLowerCase()==t&&(document.form.wl_crypto[r].selected=!0)}else if("wpa2"==n){for(r=0;r<document.form.wl_crypto.length;r++)if(document.form.wl_crypto[r].selected){t=document.form.wl_crypto[r].value;break}for(var r in o=new Array("AES"),document.form.wl_crypto.length=o.length,o)document.form.wl_crypto[r]=new Option(o[r],o[r].toLowerCase()),document.form.wl_crypto[r].value=o[r].toLowerCase(),o[r].toLowerCase()==t&&(document.form.wl_crypto[r].selected=!0)}change_wep_type(n,e);for(r=0;r<document.form.wl_key.length;r++)if(document.form.wl_key[r].selected){t=document.form.wl_key[r].value;break}for(var r in"wpa"==n||"wpa2"==n||"psk"==n||"radius"==n?o=new Array("2","3"):(o=new Array("1","2","3","4"),e||(t="1")),document.form.wl_key.length=o.length,o)document.form.wl_key[r]=new Option(o[r],o[r]),document.form.wl_key[r].value=o[r],o[r]==t&&(document.form.wl_key[r].selected=!0);wl_wep_change()}function validate_wlkey(e){var t=document.form.wl_wep_x.value,o=!0,n="<#JS_wepkey#>";return"0"==t?o=!0:"1"==t?5==e.value.length&&validate_string(e)?(document.form.wl_key_type.value=1,o=!0):10==e.value.length&&validate_hex(e)?(document.form.wl_key_type.value=0,o=!0):(n+="(<#WLANConfig11b_WEPKey_itemtype1#>)",o=!1):"2"==t?13==e.value.length&&validate_string(e)?(document.form.wl_key_type.value=1,o=!0):26==e.value.length&&validate_hex(e)?(document.form.wl_key_type.value=0,o=!0):(n+="(<#WLANConfig11b_WEPKey_itemtype2#>)",o=!1):(alert("System error!"),o=!1),0==o&&(alert(n),e.focus(),e.select()),o}