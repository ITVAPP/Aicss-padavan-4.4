var validator={ipv4cidr:function(e){return!(!new RegExp("^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(/([0-9]|[1-2][0-9]|3[0-2]))$","gi").test(e.value)&&!validator.ipAddr4(e))||(alert(e.value+" is not valid.  Please enter a valid IP, which can optionally be in CIDR format (1.2.3.4/24)."),e.focus(),e.select(),!1)},account:function(e,t){var a="";if(" "==e.value.charAt(0))return"noalert"!=t&&alert("<#JS_validstr1#> [  ]"),e.value="",e.focus(),"noalert"==t&&"<#JS_validstr1#> [&nbsp;&nbsp;&nbsp;]";if("-"==e.value.charAt(0))return"noalert"!=t&&alert("<#JS_validstr1#> [-]"),e.value="",e.focus(),"noalert"==t&&"<#JS_validstr1#> [-]";for(var n=0;n<e.value.length;++n)this.ssidChar(e.value.charCodeAt(n))&&(a+=e.value.charAt(n)),'"'!=e.value.charAt(n)&&"/"!=e.value.charAt(n)&&"\\"!=e.value.charAt(n)&&"["!=e.value.charAt(n)&&"]"!=e.value.charAt(n)&&":"!=e.value.charAt(n)&&";"!=e.value.charAt(n)&&"|"!=e.value.charAt(n)&&"="!=e.value.charAt(n)&&","!=e.value.charAt(n)&&"+"!=e.value.charAt(n)&&"*"!=e.value.charAt(n)&&"?"!=e.value.charAt(n)&&"<"!=e.value.charAt(n)&&">"!=e.value.charAt(n)&&"@"!=e.value.charAt(n)&&" "!=e.value.charAt(n)||(a+=e.value.charAt(n));return""!=a?("noalert"!=t&&alert("<#JS_validstr2#> ' "+a+" ' !"),e.value="",e.focus(),"noalert"==t&&"<#JS_validstr2#> ' "+a+" ' !"):"noalert"!=t||""},bandwidth_code:function(e,t){var a=t.keyCode?t.keyCode:t.which,n=e.value.split(".");return!!validator.isFunctionButton(t)||!(46==a&&n.length>1)&&(!(n.length>1&&n[1].length>0)&&(46==a||a>47&&a<58))},checkIP:function(e,t){e.nextSibling.nextSibling;var a=window.event?t.keyCode:t.which,n=e.value;if(a>=48&&a<=57||a>=97&&a<=105||8==a||0==a)return!0;if(190==a||32==a||110==a||46==a);else if(37!=a&&8!=a||""!=n)return a=0,!1},checkIPAddrInput:function(e,t){if(document.getElementById("check_ip_input")&&e.parentNode.removeChild(e.parentNode.childNodes[2]),!this.ipAddr4(e)||1==t&&""==e.value){var a=document.createElement("div");return a.setAttribute("id","check_ip_input"),a.style.color="#FFCC00",e.parentNode.appendChild(a),document.getElementById("check_ip_input").innerHTML="<#JS_validip#>",document.getElementById("check_ip_input").style.display="",e.value=e.parentNode.childNodes[0].innerHTML,e.focus(),e.select(),!1}return!0},checkWord:function(e,t){var a=0,n=0,r=function(e){if(e.selectionStart>=0)return e.selectionStart;var t=document.selection.createRange(),a=t.duplicate();e.select();for(var n=document.selection.createRange(),r=0;a.compareEndPoints("StartToStart",n)>0;)a.moveStart("character",-1),r++;return t.select(),r},l=function(e){return!(e.value<0||e.value>=256)||(alert(e.value+" <#BM_alert_IP2#>. \n<#BM_alert_port1#> 0<#BM_alert_to#>255."),e.focus(),e.select(),!1)},u=e.nextSibling.nextSibling,i=e.previousSibling;i=null!=i?i.previousSibling:e;var o=window.event?t.keyCode:t.which,d=e.value;if(o>=48&&o<=57||o>=97&&o<=105||0==o)3==d.length?3==r(e)&&u?l(e)&&(u.focus(),u.select()):l(e):d.length==r(e)&&(n=1),a=0;else if(190==o||110==o||32==o)"."==e.value||".."==e.value||"..."==e.value||" "==e.value||"  "==e.value||"   "==e.value?(e.value="",e.focus()):(this.validateIP(e),u&&(u.focus(),u.select()));else if(8==o)0==r(e)&&0==a?a=1:0==r(e)&&i&&(i.focus(),i.select(),a=0,n=1);else if(37==o)0==r(e)&&0==a?a=1:i&&0==r(e)&&1==a?(i.focus(),i.select(),a=0):a=0,n=0;else{if(39!=o)return isNaN(d)&&d.length>=1&&13!=o?(alert("<#LANHostConfig_x_DDNS_alarm_9#>"),e.focus(),e.select(),!1):(nc=0,!1);0==r(e)&&0==d.length&&u&&l(e)?(u.focus(),n=0,a=1):r(e)==d.length&&0==n?(n=1,a=0):1==n&&u&&l(e)?(u.focus(),n=0,a=1):a=0}},eachPort:function(e,t,a,n){return t<a||t>n?(alert("<#JS_validport#>"),!1):(""==e.value&&(e.value="0"),!0)},hex:function(e){var t=e.value;return!new RegExp("[^a-fA-F0-9]+","gi").test(t)},haveFullWidthChar:function(e){return!e.value.match(/[^\x00-\xff]/g)},hostName:function(e){return new RegExp(/^[a-z0-9][a-z0-9-_]+$/i).test(e.value)?"":"/"==location.pathname||"<% abs_index_page(); %>"==location.pathname?'Client device name only accept alphanumeric characters, under line and dash symbol. The first character cannot be dash "-" or under line "_".':e.value.length<2?"<#JS_short_username#>":"<#JS_validhostname#>"},hostNameChar:function(e){return e>=48&&e<=57||(e>=97&&e<=122||(e>=65&&e<=90||(45==e||46==e)))},domainName:function(e){return new RegExp(/^(?:[a-z0-9](?:[a-z0-9-_]{0,61}[a-z0-9])?\.)*[a-z0-9][a-z0-9-_]{0,61}[a-z0-9]$/i).test(e.value)?"":"<#JS_validhostname#>"},requireWANIP:function(e){return"wan_ipaddr_x"==e||"wan_netmask_x"==e||"lan_ipaddr"==e||"lan_netmask"==e||"lan1_ipaddr"==e||"lan1_netmask"==e?"static"==document.form.wan_proto.value||"pppoe"==document.form.wan_proto.value&&this.inet_network(document.form.wan_ipaddr_x.value)?1:"pptp"!=document.form.wan_proto.value&&"l2tp"!=document.form.wan_proto.value||"0.0.0.0"==document.form.wan_ipaddr_x.value?0:1:0},isEmpty:function(e){return""!=e.value.trim()||(alert("<#JS_fieldblank#>"),e.focus(),!1)},isFunctionButton:function(e){var t=e.keyCode;return 0==e.which&&(0==t||27==t||35==t||36==t||37==t||39==t||45==t||46==t)||(8==t||9==t)},isHWAddr:function(e,t){var a,n,r=t.keyCode?t.keyCode:t.which;if(this.isFunctionButton(t))return!0;if(r>47&&r<58||r>64&&r<71||r>96&&r<103){for(n=0,a=0;a<e.value.length;a++)":"==e.value.charAt(a)&&n++;return n<5&&a>=2&&":"!=e.value.charAt(a-2)&&":"!=e.value.charAt(a-1)&&(e.value=e.value+":"),!0}return 58==r||13==r||!(!t.metaKey||65!=r&&67!=r&&86!=r&&88!=r&&97!=r&&99!=r&&118!=r&&120!=r)},isNumberFloat:function(e,t){var a=t.keyCode?t.keyCode:t.which;return!!this.isFunctionButton(t)||(46==a||a>47&&a<58||!(!t.metaKey||65!=a&&67!=a&&86!=a&&88!=a&&97!=a&&99!=a&&118!=a&&120!=a))},isNegativeNumber:function(e,t){var a=t.keyCode?t.keyCode:t.which;return!!this.isFunctionButton(t)||(45==a||a>47&&a<58||!(!t.metaKey||65!=a&&67!=a&&86!=a&&88!=a&&97!=a&&99!=a&&118!=a&&120!=a))},isNumber:function(e,t){var a=t.keyCode?t.keyCode:t.which;return!!this.isFunctionButton(t)||(a>47&&a<58||!(!t.metaKey||65!=a&&67!=a&&86!=a&&88!=a&&97!=a&&99!=a&&118!=a&&120!=a))},isContainblanksStr:function(e){return!e.value.replace(/^\s+|\s+$/g,"").match(/\x20/i)||(e.focus(),e.select(),alert("The Name can not contain blanks"),!1)},isIPAddr:function(e,t){var a,n,r=t.keyCode?t.keyCode:t.which;if(this.isFunctionButton(t))return!0;if(r>47&&r<58){for(n=0,a=0;a<e.value.length;a++)"."==e.value.charAt(a)&&n++;return n<3&&a>=3&&"."!=e.value.charAt(a-3)&&"."!=e.value.charAt(a-2)&&"."!=e.value.charAt(a-1)&&(e.value=e.value+"."),!0}if(46==r){for(n=0,a=0;a<e.value.length;a++)"."==e.value.charAt(a)&&n++;return"."!=e.value.charAt(a-1)&&3!=n}return 13==r||!(!t.metaKey||65!=r&&67!=r&&86!=r&&88!=r&&97!=r&&99!=r&&118!=r&&120!=r)},isIPAddrPlusNetmask:function(e,t){var a,n,r=t.keyCode?t.keyCode:t.which;if(this.isFunctionButton(t))return!0;if(r>47&&r<58){for(n=0,a=0;a<e.value.length;a++)"."==e.value.charAt(a)&&n++;return n<3&&a>=3&&"."!=e.value.charAt(a-3)&&"."!=e.value.charAt(a-2)&&"."!=e.value.charAt(a-1)&&(e.value=e.value+"."),!0}if(46==r){for(n=0,a=0;a<e.value.length;a++)"."==e.value.charAt(a)&&n++;return"."!=e.value.charAt(a-1)&&3!=n}if(47==r){for(n=0,a=0;a<e.value.length;a++)"."==e.value.charAt(a)&&n++;return!(n<3)}return!1},isIPRange:function(e,t){var a,n,r=t.keyCode?t.keyCode:t.which;if(this.isFunctionButton(t))return!0;if(r>47&&r<58){for(n=0,a=0;a<e.value.length;a++)"."==e.value.charAt(a)&&n++;return n<3&&a>=3&&"."!=e.value.charAt(a-3)&&"."!=e.value.charAt(a-2)&&"."!=e.value.charAt(a-1)&&(e.value=e.value+"."),!0}if(46==r){for(n=0,a=0;a<e.value.length;a++)"."==e.value.charAt(a)&&n++;return"."!=e.value.charAt(a-1)&&3!=n}return 42==r},isLegalIP:function(e,t){var a=inet_network("1.0.0.0"),n=inet_network("126.255.255.255"),r=inet_network("127.0.0.0"),l=inet_network("127.255.255.255"),u=inet_network("128.0.0.0"),i=inet_network("255.255.255.255"),o=e,d=inet_network(o.value);return"DNS"==t&&-1==d||("GW"==t&&-1==d||(d>a&&d<n?(e.value=ipFilterZero(o.value),!0):d>r&&d<l?(alert(o.value+" <#JS_validip#>"),o.focus(),o.select(),!1):d>u&&d<i?(e.value=ipFilterZero(o.value),!0):(alert(o.value+" <#JS_validip#>"),o.focus(),o.select(),!1)))},isLegalMask:function(e){var t=0,a=e,n=inet_network(a.value),r=0;if(-1!=n){for(n<0&&(t=1),r=0==n?0:~n;0!=r;){if((r+1)%2!=0){t=1;break}r=(r+1)/2-1}return 1!=t||(alert(a.value+" is not a valid Mask address!"),a.focus(),a.select(),!1)}return alert("This is not a valid Mask address!"),a.focus(),a.select(),!1},isLegalIPAndMask:function(e){var t=inet_network("1.0.0.0"),a=inet_network("126.255.255.255"),n=inet_network("127.0.0.0"),r=inet_network("127.255.255.255"),l=inet_network("128.0.0.0"),u=inet_network("255.255.255.255"),i=e,o=i.value.split("/"),d=function(){var e=parseInt(o[1]);return""==parseInt(o[1])||isNaN(e)?(alert("This is not a valid IP/Mask address!"),i.focus(),i.select(),!1):!(parseInt(o[1])<0||parseInt(o[1])>32)||(alert(o[1]+" is not a valid Mask address!"),i.focus(),i.select(),!1)};if(2!=o.length)return alert("This is not a valid IP/Mask address!"),i.focus(),i.select(),!1;var s=inet_network(o[0]);if(s>t&&s<a){if(d())return e.value=ipFilterZero(o[0])+"/"+o[1],!0}else{if(s>n&&s<r)return alert(o[0]+" <#JS_validip#>"),i.focus(),i.select(),!1;if(!(s>l&&s<u))return alert(o[0]+" <#JS_validip#>"),i.focus(),i.select(),!1;if(d())return e.value=ipFilterZero(o[0])+"/"+o[1],!0}},isLegal_ipv6:function(e){var t=function(e){if(0==e.length||e.length>4)return!1;var t;e=e.toLowerCase();for(var a=0;a<e.length;a++)if(!((t=e.charAt(a))>="0"&&t<="9"||t>="a"&&t<="f"))return!1;return!0},a=e.value.indexOf("::");if(-1==a){if(8!=(r=e.value.split(":")).length)return alert(e.value+" <#JS_validip#>"),e.focus(),!1;for(var n=0;n<r.length;n+=1)if(!t(r[n]))return alert(e.value+" <#JS_validip#>"),e.focus(),!1;return!0}if(a!=e.value.lastIndexOf("::"))return alert(e.value+" <#JS_validip#>"),e.focus(),!1;var r,l=(r=e.value.split("::"))[0].split(":"),u=r[1].split(":");if(l.length+u.length>7)return alert(e.value+" <#JS_validip#>"),e.focus(),!1;for(n=0;n<l.length;n+=1)if(!t(l[n]))return alert(e.value+" <#JS_validip#>"),e.focus(),!1;for(n=0;n<u.length;n+=1)if(!t(u[n]))return alert(e.value+" <#JS_validip#>"),e.focus(),!1;return!0},isPortRange:function(e,t){var a=t.keyCode?t.keyCode:t.which;if(this.isFunctionButton(t))return!0;if(a>47&&a<58)return!0;if(58==a&&e.value.length>0){for(var n=0;n<e.value.length;n++){var r=e.value.charAt(n);if(":"==r||">"==r||"<"==r||"="==r)return!1}return!0}return 44==a?0!=e.value.length:60==a||62==a?0==e.value.length:!(!t.metaKey||65!=a&&67!=a&&86!=a&&88!=a&&97!=a&&99!=a&&118!=a&&120!=a)},isPortlist:function(e,t){var a=t.keyCode?t.keyCode:t.which;return!!this.isFunctionButton(t)||(a>47&&a<58||32==a||!(!t.metaKey||65!=a&&67!=a&&86!=a&&88!=a&&97!=a&&99!=a&&118!=a&&120!=a))},isPrivateIP:function(e){var t=this.inet_network("10.0.0.0"),a=this.inet_network("10.255.255.255"),n=this.inet_network("172.16.0.0"),r=this.inet_network("172.31.255.255"),l=this.inet_network("192.168.0.0"),u=this.inet_network("192.168.255.255"),i=this.inet_network(e);return i>t&&i<a||(i>n&&i<r||i>l&&i<u)},isString:function(e,t){var a=t.keyCode?t.keyCode:t.which;return a>=0&&a<=126||(alert("<#JS_validchar#>"),!1)},isValidURL:function(e){return!!new RegExp("^(http|https|ftp)://([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&amp;%$-]+)*@)*((25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]).(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0).(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0).(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])|([a-zA-Z0-9-]+.)*[a-zA-Z0-9-]+.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(/($|[a-zA-Z0-9.,?'\\+&amp;%$#=~_-]+))*$").test(e)||(alert("It is invalid URL."),!1)},inet_network:function(e){if(!e)return-1;if(/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/.test(e)){var t=parseInt(RegExp.$1),a=parseInt(RegExp.$2),n=parseInt(RegExp.$3),r=parseInt(RegExp.$4);if(t<256&&a<256&&n<256&&r<256)return 256*t*256*256+256*a*256+256*n+r}return-2},ipAddr4:function(e){var t=-1,a=0;if(""==e.value)return!0;for(var n=0;n<e.value.length;++n){var r=e.value.charAt(n);if(r>="0"&&r<="9")t=-1==t?r-"0":10*t+(r-"0");else{if(t<0||t>255||"."!=r)return!1;0==a?t:1==a?t:2==a&&t,t=-1,++a}}return!(3!=a||t<0||t>255)&&(t,!0)},ipAddrFinal:function(e,t,a){var n,r,l,u,i=-1,o=0;if(0==e.value.length)return"dhcp_start"!=t&&"dhcp_end"!=t&&"wan_ipaddr_x"!=t&&"dhcp1_start"!=t&&"dhcp1_end"!=t&&"lan_ipaddr"!=t&&"lan_netmask"!=t&&"lan1_ipaddr"!=t&&"lan1_netmask"!=t&&"wl_radius_ipaddr"!=t&&"hs_radius_ipaddr"!=t||(alert("<#JS_fieldblank#>"),"wan_ipaddr_x"==t?(document.form.wan_ipaddr_x.value="10.1.1.1",document.form.wan_netmask_x.value="255.0.0.0"):"lan_ipaddr"==t?(document.form.lan_ipaddr.value="192.168.1.1",document.form.lan_netmask.value="255.255.255.0"):"lan1_ipaddr"==t?(document.form.lan1_ipaddr.value="192.168.2.1",document.form.lan1_netmask.value="255.255.255.0"):"lan_netmask"==t?document.form.lan_netmask.value="255.255.255.0":"lan1_netmask"==t&&(document.form.lan1_netmask.value="255.255.255.0"),e.focus(),e.select(),!1);"wan_ipaddr_x"==t&&""==document.form.wan_netmask_x.value&&(document.form.wan_netmask_x.value="255.255.255.0");for(var d=0;d<e.value.length;++d){var s=e.value.charAt(d);if(s>="0"&&s<="9")i=-1==i?s-"0":10*i+(s-"0");else{if(i<0||i>255||"."!=s)return"wl_radius_ipaddr"==t&&null!=typeof a&&1==a||(alert(e.value+" <#JS_validip#>"),e.value="",e.focus(),e.select()),!1;0==o?n=i:1==o?r=i:2==o&&(l=i),i=-1,++o}}if(3!=o||i<0||i>255)return"wl_radius_ipaddr"==t&&null!=typeof a&&1==a||(alert(e.value+" <#JS_validip#>"),e.value="",e.focus(),e.select()),!1;if(u=i,"dhcp_start"==t||"dhcp_end"==t||"wan_ipaddr_x"==t||"dhcp1_start"==t||"dhcp1_end"==t||"lan_ipaddr"==t||"lan1_ipaddr"==t||"staticip"==t||"wl_radius_ipaddr"==t||"dhcp_dns1_x"==t||"dhcp_gateway_x"==t||"dhcp_wins_x"==t||"sip_server"==t){if("wan_ipaddr_x"!=t&&(255==n||255==u||0==n||0==u||127==n||224==n))return"wl_radius_ipaddr"==t&&null!=typeof a&&1==a||(alert(e.value+" <#JS_validip#>"),e.value="",e.focus(),e.select()),!1;if("2"==sw_mode||"3"==sw_mode);else if(this.requireWANIP(t)&&("wan_ipaddr_x"==t&&this.matchSubnet2(e.value,document.form.wan_netmask_x,document.form.lan_ipaddr.value,document.form.lan_netmask)||"lan_ipaddr"==t&&this.matchSubnet2(e.value,document.form.lan_netmask,document.form.wan_ipaddr_x.value,document.form.wan_netmask_x)))return alert(e.value+" <#JS_validip#>"),"wan_ipaddr_x"==t?(document.form.wan_ipaddr_x.value="10.1.1.1",document.form.wan_netmask_x.value="255.0.0.0"):"lan_ipaddr"==t?(document.form.lan_ipaddr.value="192.168.1.1",document.form.lan_netmask.value="255.255.255.0"):"lan1_ipaddr"==t&&(document.form.lan1_ipaddr.value="192.168.2.1",document.form.lan1_netmask.value="255.255.255.0"),e.focus(),e.select(),!1}else if(("lan_netmask"==t||"lan1_netmask"==t)&&255==n&&255==r&&255==l&&255==u)return alert(e.value+" <#JS_validip#>"),e.value="",e.focus(),e.select(),!1;if("2"==sw_mode||"3"==sw_mode);else if(this.requireWANIP(t)&&("wan_netmask_x"==t&&this.matchSubnet2(document.form.wan_ipaddr_x.value,e,document.form.lan_ipaddr.value,document.form.lan_netmask)||"lan_netmask"==t&&this.matchSubnet2(document.form.lan_ipaddr.value,e,document.form.wan_ipaddr_x.value,document.form.wan_netmask_x)))return alert(e.value+" <#JS_validip#>"),"wan_netmask_x"==t?(document.form.wan_ipaddr_x.value="10.1.1.1",document.form.wan_netmask_x.value="255.0.0.0"):"lan_netmask"==t?(document.form.lan_ipaddr.value="192.168.1.1",document.form.lan_netmask.value="255.255.255.0"):"lan1_netmask"==t&&(document.form.lan1_ipaddr.value="192.168.2.1",document.form.lan1_netmask.value="255.255.255.0"),e.focus(),e.select(),!1;if(e.value=n+"."+r+"."+l+"."+u,mask=n>0&&n<127?"255.0.0.0":n>127&&n<192?"255.255.0.0":n>191&&n<224?"255.255.255.0":"0.0.0.0","wan_ipaddr_x"==t&&""==document.form.wan_netmask_x.value)document.form.wan_netmask_x.value=mask;else if("lan_ipaddr"==t&&""==document.form.lan_netmask.value)document.form.lan_netmask.value=mask;else if("dhcp_start"==t){if(!this.matchSubnet(document.form.lan_ipaddr.value,document.form.dhcp_start.value,3))return alert(e.value+" <#JS_validip#>"),e.focus(),e.select(),!1}else if("dhcp_end"==t){if(!this.matchSubnet(document.form.lan_ipaddr.value,document.form.dhcp_end.value,3))return alert(e.value+" <#JS_validip#>"),e.focus(),e.select(),!1}else if("lan1_ipaddr"==t)""==document.form.lan1_netmask.value&&(document.form.lan1_netmask.value=mask);else if("dhcp1_start"==t){if(!this.matchSubnet(document.form.lan1_ipaddr.value,document.form.dhcp1_start.value,3))return alert(e.value+" <#JS_validip#>"),e.focus(),e.select(),!1}else if("dhcp1_end"==t&&!this.matchSubnet(document.form.lan1_ipaddr.value,document.form.dhcp1_end.value,3))return alert(e.value+" <#JS_validip#>"),e.focus(),e.select(),!1;return!0},ipAddrFinalQIS:function(e,t){var a=function(e){return!!/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(e.value)};if("wan_ipaddr_x"==t){if(0==e.value.length)return document.getElementById(e.name+"_div")&&(document.getElementById(e.name+"_div").style.border="2px solid #CE1E1E"),alert(e.title+"<#JS_fieldblank#>"),document.form.wan_ipaddr_x1.focus(),!1;if(0==e.value.indexOf("0"))return document.getElementById(e.name+"_div")&&(document.getElementById(e.name+"_div").style.border="2px solid #CE1E1E"),alert(document.form.wan_ipaddr_x.value+" <#JS_validip#>"),document.form.wan_ipaddr_x1.focus(),!1;if(!a(e))return document.getElementById(e.name+"_div")&&(document.getElementById(e.name+"_div").style.border="2px solid #CE1E1E"),alert(document.form.wan_ipaddr_x.value+" <#JS_validip#>"),document.form.wan_ipaddr_x4.focus(),!1;if(a(e))return document.form.wan_ipaddr_x1.value>=224?(alert("<#JS_field_wanip_rule2#>"),document.form.wan_ipaddr_x1.focus(),document.form.wan_ipaddr_x1.select(),!1):127!=document.form.wan_ipaddr_x1.value||(alert(document.form.wan_ipaddr_x1.value+"<#JS_field_wanip_rule1#>"),document.form.wan_ipaddr_x1.focus(),document.form.wan_ipaddr_x1.select(),!1)}else if("wan_netmask_x"==t){var n=document.form.wan_ipaddr_x1.value;if(0==e.value.length)return document.getElementById(e.name+"_div")&&(document.getElementById(e.name+"_div").style.border="2px solid #CE1E1E"),confirm(e.title+"<#JS_fieldblank#>\n<#JS_field_fulfillSubmask#>")&&(e.value=n>0&&n<127?"255.0.0.0":n>127&&n<192?"255.255.0.0":n>191&&n<224?"255.255.255.0":"0.0.0.0",function(e){for(var t=e.value.split("."),a=document.getElementById(e.name+"_div").childNodes,n=0,r=0;a.length,r<t.length;n++)"text"==a[n].type&&(a[n].value=t[r],r++)}(e)),document.form.wan_netmask_x1.focus(),!1;if(!a(e))return document.getElementById(e.name+"_div")&&(document.getElementById(e.name+"_div").style.border="2px solid #CE1E1E"),alert(e.value+" <#JS_validip#>"),!1;if(a(e))return!this.requireWANIP(t)||!this.matchSubnet2(document.form.wan_ipaddr_x.value,e,document.form.lan_ipaddr.value,document.form.lan_netmask)||(document.getElementById(e.name+"_div")&&(document.getElementById(e.name+"_div").style.border="2px solid #CE1E1E"),alert(e.value+" <#JS_validip#>"),!1)}else{if("wan_gateway_x"==t){if(e.value.length>0){if(!a(e))return document.getElementById(e.name+"_div")&&(document.getElementById(e.name+"_div").style.border="2px solid #CE1E1E"),alert(e.value+" <#JS_validip#>"),!1;if(e.value==document.form.wan_ipaddr_x.value)return document.getElementById(e.name+"_div")&&(document.getElementById(e.name+"_div").style.border="2px solid #CE1E1E"),alert("<#IPConnection_warning_WANIPEQUALGatewayIP#>"),!1}return!0}if("wan_dns1_x"==t||"wan_dns2_x"==t){e.value.split(".");return!!a(e)||(document.getElementById(e.name+"_div")&&(document.getElementById(e.name+"_div").style.border="2px solid #CE1E1E"),alert(e.value+" <#JS_validip#>"),!1)}}},ipList:function(e,t){var a;if(null==t.which)a=t.keyCode;else{if(0==t.which||0==t.charCode)return!0;a=t.which}return a>=48&&a<=57||46==a||44==a},ipRange:function(e,t){var a=-1,n=0;if(0==e.value.length)return!0;for(var r=0;r<e.value.length;r++){var l=e.value.charAt(r);if(l>="0"&&l<="9")a=-1==a?l-"0":10*a+(l-"0");else if("*"==l&&-1==a)a=0;else{if(a<0||a>255||"."!=l)return alert(e.value+" <#JS_validip#>"),e.value="",e.focus(),e.select(),!1;a=-1,n++}}return 3!=n||a<0||a>255?(alert(e.value+" <#JS_validip#>"),e.value="",e.focus(),e.select(),!1):("ExternalIPAddress"==t&&""==document.form.wan_netmask_x.value?document.form.wan_netmask_x.value="255.255.255.0":"IPRouters"==t&&""==document.form.lan_netmask.value&&(document.form.lan_netmask.value="255.255.255.0"),!0)},ipSubnet:function(e){var t=new RegExp("(^([0-9]{1,3})\\.([0-9]{1,3})\\.([0-9]{1,3})\\.(\\*)$)","gi"),a=new RegExp("(^([0-9]{1,3})\\.([0-9]{1,3})\\.(\\*)\\.(\\*)$)","gi"),n=new RegExp("(^([0-9]{1,3})\\.(\\*)\\.(\\*)\\.(\\*)$)","gi"),r=new RegExp("(^(\\*)\\.(\\*)\\.(\\*)\\.(\\*)$)","gi"),l=e.value.split(".");return(t.test(e.value)||a.test(e.value)||n.test(e.value)||r.test(e.value))&&!(0==l[0]||l[0]>255||l[1]>255||l[2]>255)||(alert(e.value+" <#JS_validip#>"),e.focus(),e.select(),!1)},maskRange:function(e,t,a){var n=inet_network(e),r=inet_network(t),l=inet_network(a);return!(n>l||r<l)},matchSubnet:function(e,t,a){var n=0,r=0,l=0;for(i=0;i<e.length;i++){if("."==e.charAt(i)){if("."!=t.charAt(i))return!1;if(n++,r!=l)return!1;r=0,l=0}else{if("."==t.charAt(i))return!1;r=10*r+(e.charAt(i)-"0"),l=10*l+(t.charAt(i)-"0")}if(n==a)return!0}return!1},matchSubnet2:function(e,t,a,n){var r,l=this.inet_network(t.value),u=this.inet_network(n.value),i=this.inet_network(e);return 0==i||-1==i?1:(r=l<u&&0!=l?l:u,(this.inet_network(e)&r)==(this.inet_network(a)&r)?1:0)},numberRange:function(e,t,a){var n=e.value;return new RegExp("^([0-9]{1,5}):([0-9]{1,5})$","gi").test(n)?parseInt(RegExp.$1)>=parseInt(RegExp.$2)?(alert("<#JS_validport#>"),e.focus(),e.select(),!1):!(!this.eachPort(e,RegExp.$1,t,a)||!this.eachPort(e,RegExp.$2,t,a))||(e.focus(),e.select(),!1):!!this.range(e,t,a)||(e.focus(),e.select(),!1)},portList:function(e,t){if(0==e.value.length)return!0;for(var a=0,n=0;n<e.value.length;n++){var r=e.value.charAt(n);if(r>="0"&&r<="9")a=10*a+(r-"0");else{if(a>255)return alert(a+" <#JS_validport#>"),e.focus(),e.select(),!1;a=0}}return!(a>255)||(alert(a+" <#JS_validport#>"),e.focus(),e.select(),!1)},psk:function(e,t){var a=e.value.length;return a<8?(alert("<#JS_passzero#>"),e.value="00000000",e.focus(),e.select(),!1):a>64||a>=8&&a<=63&&!this.string(e)?(alert("<#JS_PSK64Hex#>"),e.focus(),e.select(),!1):!(64==a&&!this.hex(e))||(alert("<#JS_PSK64Hex#>"),e.focus(),e.select(),!1)},psk_KR:function(e,t){var a=e.value.length;if(!/[A-Za-z]/.test(e.value)||!/[0-9]/.test(e.value)||a<8||a>63||!/[\!\"\#\$\%\&\'\(\)\*\+\,\-\.\/\:\;\<\=\>\?\@\[\\\]\^\_\`\{\|\}\~]/.test(e.value))return alert("<#JS_PSK64Hex_kr#> <#JS_validPWD#>"),e.value="",e.focus(),!1;for(var n="",r=0;r<a;++r)(e.value.charAt(r)<=" "||e.value.charAt(r)>"~")&&(n+=e.value.charAt(r));return""==n||("noalert"!=t&&alert("<#JS_validstr2#> '"+n+"' !"),e.value="",e.focus(),!1)},range:function(e,t,a){if(t>a){var n;n=t,t=a,a=n}return isNaN(e.value)||e.value<t||e.value>a?(alert("<#JS_validrange#> "+t+" <#JS_validrange_to#> "+a),e.focus(),e.select(),!1):(e.value=function(e){for(i=0;i<e.length&&"0"==e.charAt(i);i++);return e.substring(i)}(e.value),""==e.value&&(e.value="0"),!0)},rangeNull:function(e,t,a,n){return""==e.value||(!(isNaN(e.value)||e.value<t||e.value>a)||(alert("<#JS_validrange#> "+t+" <#JS_validrange_to#> "+a+"."),e.value=n,e.focus(),e.select(),!1))},rangeAllowZero:function(e,t,a,n){return 0==e.value||(isNaN(e.value)||e.value<t||e.value>a?(alert("<#JS_validrange#> "+t+" <#JS_validrange_to#> "+a+"."),e.value=n,e.focus(),e.select(),!1):(e.value=function(e){for(i=0;i<e.length&&"0"==e.charAt(i);i++);return e.substring(i)}(e.value),""==e.value&&(e.value="0"),!0))},rangeFloat:function(e,t,a,n){return!(isNaN(e.value)||e.value<=t||e.value>a)||(alert("<#JS_validrange#> "+min+" <#JS_validrange_to#> "+max+"."),e.value=n,e.focus(),e.select(),!1)},lengthInUtf8:function(e){return(e.match(/[\u0000-\u007f]/g)?e.match(/[\u0000-\u007f]/g).length:0)+(encodeURI(e.replace(/[\u0000-\u007f]/g)).match(/%/g)?encodeURI(e.replace(/[\u0000-\u007f]/g,"")).match(/%/g).length:0)},ssidChar:function(e){return!(e>=32&&e<=126)},string:function(e,t){if('"'==e.value.charAt(0))return"noalert"!=t&&alert('<#JS_validstr1#> ["]'),e.value="",e.focus(),!1;for(var a="",n=0;n<e.value.length;++n)(e.value.charAt(n)<" "||e.value.charAt(n)>"~")&&(a+=e.value.charAt(n));return""==a||("noalert"!=t&&alert("<#JS_validstr2#> '"+a+"' !"),e.value="",e.focus(),!1)},string_KR:function(e,t){var a=e.value.length;if(!/[A-Za-z]/.test(e.value)||!/[0-9]/.test(e.value)||a<8||!/[\!\"\#\$\%\&\'\(\)\*\+\,\-\.\/\:\;\<\=\>\?\@\[\\\]\^\_\`\{\|\}\~]/.test(e.value))return alert("<#JS_validPWD#>"),e.value="",e.focus(),!1;for(var n="",r=0;r<e.value.length;++r)(e.value.charAt(r)<=" "||e.value.charAt(r)>"~")&&(n+=e.value.charAt(r));return""==n||("noalert"!=t&&alert("<#JS_validstr2#> '"+n+"' !"),e.value="",e.focus(),!1)},stringGroup:function(e){for(var t,a,n=0;n<e.value.length;++n)if(t=e.value.charCodeAt(n),60==(a=t)||62==a)return alert("<#JS_validSSID1#> "+e.value.charAt(n)+" <#JS_validSSID2#>"),e.focus(),e.select(),!1;return!0},stringSSID:function(e){var t,a=-1!='<% nvram_get("rc_support"); %>'.split(" ").indexOf("utf8_ssid"),n=0;if(""==e.value)return alert("<#JS_fieldblank#>"),e.focus(),!1;if(len=this.lengthInUtf8(e.value),len>32)return alert("SSID length is over 32 characters"),e.value="",e.focus(),e.select(),!1;for(var r=0;r<len;++r){if(t=e.value.charCodeAt(r),!a&&this.ssidChar(t))return alert("<#JS_validSSID1#> "+e.value.charAt(r)+" <#JS_validSSID2#>"),e.value="",e.focus(),e.select(),!1;32!=t&&n++}return 0!=n||(alert("<#JS_fieldblank#>"),!1)},subnetAndMaskCombination:function(e,t){var a,n=inet_network(e),r=e.split("."),l=t.split(".");return a=(r[0]&l[0])+"."+(r[1]&l[1])+"."+(r[2]&l[2])+"."+(r[3]&l[3]),inet_network(a)-n==0},timeRange:function(e,t){if(0==e.value.length?e.value="00":1==e.value.length&&(e.value="0"+e.value),e.value.charAt(0)<"0"||e.value.charAt(0)>"9")e.value="00";else{if(!(e.value.charAt(1)<"0"||e.value.charAt(1)>"9"))return 0==t||2==t?!(e.value>23)||(alert("<#JS_validrange#> 00 <#JS_validrange_to#> 23"),e.value="00",e.focus(),e.select(),!1):!(e.value>59)||(alert("<#JS_validrange#> 00 <#JS_validrange_to#> 59"),e.value="00",e.focus(),e.select(),!1);e.value="00"}return!0},validateIP:function(e){var t=e.value;0==t.indexOf(".")||0==t.indexOf(" ")?e.value=t.substring(1,2):1==t.indexOf(".")||1==t.indexOf(" ")?e.value=t.substring(0,1):2!=t.indexOf(".")&&2!=t.indexOf(" ")||(e.value=t.substring(0,2))},validIPForm:function(e,t){if(""==e.value)return!0;if(0==t)return!!this.ipAddrFinal(e,e.name)||(e.focus(),e.select(),!1);if(1==t){var a=e.value,n=new RegExp("^([0-9]{1,3}).([0-9]{1,3}).([0-9]{1,3}).([0-9]{1,3})$","gi");return this.ipAddrFinal(e,e.name)?("sr_ipaddr_x_0"==e.name&&n.test(a)?RegExp.$1>0&&RegExp.$1<127?document.form.sr_netmask_x_0.value="255.0.0.0":RegExp.$1>127&&RegExp.$1<192?document.form.sr_netmask_x_0.value="255.255.0.0":RegExp.$1>191&&RegExp.$1<224?document.form.sr_netmask_x_0.value="255.255.255.0":document.form.sr_netmask_x_0.value="0.0.0.0":"wan_ipaddr_x"==e.name&&n.test(a)?RegExp.$1>0&&RegExp.$1<127?document.form.wan_netmask_x.value="255.0.0.0":RegExp.$1>127&&RegExp.$1<192?document.form.wan_netmask_x.value="255.255.0.0":RegExp.$1>191&&RegExp.$1<224?document.form.wan_netmask_x.value="255.255.255.0":document.form.wan_netmask_x.value="0.0.0.0":"lan_ipaddr"==e.name&&n.test(a)&&(RegExp.$1>0&&RegExp.$1<127?document.form.lan_netmask.value="255.0.0.0":RegExp.$1>127&&RegExp.$1<192?document.form.lan_netmask.value="255.255.0.0":RegExp.$1>191&&RegExp.$1<224?document.form.lan_netmask.value="255.255.255.0":document.form.lan_netmask.value="0.0.0.0"),!0):(e.focus(),e.select(),!1)}if(2==t){if(-1==e.value.search("/"))return!!this.ipAddrFinal(e,e.name)||(e.focus(),e.select(),!1);if(e.value.split("/").length>2)return alert(e.value+" <#JS_validip#>"),e.value="",e.focus(),e.select(),!1;if(""==e.value.split("/")[1]||0==e.value.split("/")[1]||e.value.split("/")[1]>32)return alert(e.value+" <#JS_validip#>"),e.value="",e.focus(),e.select(),!1;var r=e.value;return e.value=e.value.split("/")[0],this.ipAddrFinal(e,e.name)?(e.value=r,!0):(e.focus(),e.select(),!1)}return!1},wlKey:function(e){var t=document.form.wl_wep_x.value,a=!0,n="<#JS_wepkey#>";return"0"==t?a=!0:"1"==t?5==e.value.length&&this.string(e)?(document.form.wl_key_type.value=1,a=!0):10==e.value.length&&this.hex(e)?(document.form.wl_key_type.value=0,a=!0):(n+="(<#WLANConfig11b_WEPKey_itemtype1#>)",a=!1):"2"==t?13==e.value.length&&this.string(e)?(document.form.wl_key_type.value=1,a=!0):26==e.value.length&&this.hex(e)?(document.form.wl_key_type.value=0,a=!0):(n+="(<#WLANConfig11b_WEPKey_itemtype2#>)",a=!1):(alert("System error!"),a=!1),0==a&&(alert(n),e.focus(),e.select()),a},WPAPSK:function(e){return!(e.value.length>=64)||(e.value=e.value.substring(0,63),alert("<#JS_wpapass#>"),!1)},mac_addr:function(e){return!!new RegExp("(([a-fA-F0-9]{2}(:|$)){6})","gi").test(e)},ipv4_addr:function(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)},ipv4_addr_range:function(e){if(/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(\*)$/.test(e))return!0;if(/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)-(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))$/.test(e)){var t=e.split(".")[3].split("-");return parseInt(t[0])<parseInt(t[1])}return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\/(3[0-2]|2[0-9]|1[0-9]|[1-9])$/.test(e)},domainName_flag:function(e){return!!/^((?:(?:(?:\w[\.\-\+]?)*)\w)+)((?:(?:(?:\w[\.\-\+]?){0,62})\w)+)\.(\w{2,6})$/.test(e)}};