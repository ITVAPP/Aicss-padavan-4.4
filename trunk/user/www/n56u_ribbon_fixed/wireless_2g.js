var wep1,wep2,wep3,wep4;function automode_hint(){var e=document.form.rt_gmode.value;"2"!=e&&"5"!=e&&"6"!=e||1!=document.form.rt_wep_x.value&&2!=document.form.rt_wep_x.value&&"radius"!=document.form.rt_auth_mode.value&&(0!=document.form.rt_crypto.value.indexOf("tkip")||document.form.rt_crypto.disabled)?$("rt_gmode_hint").style.display="none":$("rt_gmode_hint").style.display="block"}function nmode_limitation(){"3"==document.form.rt_gmode.value&&(0!=document.form.rt_auth_mode.selectedIndex||"1"!=document.form.rt_wep_x.selectedIndex&&"2"!=document.form.rt_wep_x.selectedIndex?1==document.form.rt_auth_mode.selectedIndex||2==document.form.rt_auth_mode.selectedIndex?(alert("<#WLANConfig11n_nmode_limition_hint#>"),document.form.rt_auth_mode.selectedIndex=3,document.form.rt_wpa_mode.value=2):5==document.form.rt_auth_mode.selectedIndex?(alert("<#WLANConfig11n_nmode_limition_hint#>"),document.form.rt_auth_mode.selectedIndex=6):7!=document.form.rt_auth_mode.selectedIndex||0!=document.form.rt_crypto.selectedIndex&&2!=document.form.rt_crypto.selectedIndex||(alert("<#WLANConfig11n_nmode_limition_hint#>"),document.form.rt_crypto.selectedIndex=1):(alert("<#WLANConfig11n_nmode_limition_hint#>"),document.form.rt_auth_mode.selectedIndex=0,document.form.rt_wep_x.selectedIndex=0),rt_auth_mode_change(0))}function RefreshRateSetList(e,t){orig=document.form.WLANConfig11b_DataRate.value,free_options(document.form.WLANConfig11b_DataRate),"3"!=e?(items=new Array("1 & 2 Mbps","Default","All"),t&&(orig=1)):(items=new Array("1 & 2 Mbps","Default"),t&&(orig=1)),add_options_x(document.form.WLANConfig11b_DataRate,items,orig)}function change_common_rt(o,s,v){if(change=1,pageChanged=1,"rt_auth_mode"==v)rt_auth_mode_change(0),"psk"==o.value||"wpa"==o.value?(opts=document.form.rt_auth_mode.options,"WPA-Personal"==opts[opts.selectedIndex].text?(document.form.rt_wpa_mode.value="1",automode_hint()):"WPA2-Personal"==opts[opts.selectedIndex].text?document.form.rt_wpa_mode.value="2":"WPA-Auto-Personal"==opts[opts.selectedIndex].text?document.form.rt_wpa_mode.value="0":"WPA-Enterprise"==opts[opts.selectedIndex].text?document.form.rt_wpa_mode.value="3":"WPA-Auto-Enterprise"==opts[opts.selectedIndex].text&&(document.form.rt_wpa_mode.value="4"),"psk"==o.value&&(document.form.rt_wpa_psk.focus(),document.form.rt_wpa_psk.select())):"shared"==o.value&&(document.form.rt_key1.focus(),document.form.rt_key1.select()),nmode_limitation(),automode_hint();else if("rt_crypto"==v)rt_auth_mode_change(0),nmode_limitation(),automode_hint();else if("rt_wep_x"==v)change_wlweptype(o,"WLANConfig11b"),nmode_limitation(),automode_hint();else if("rt_key"==v){var selected_key=eval("document.form.rt_key"+o.value);selected_key.focus(),selected_key.select()}else"rt_country_code"==v?(insertChannelOption(),insertExtChannelOption()):"rt_channel"==v?insertExtChannelOption():"rt_HT_BW"==v?(automode_hint(),insertExtChannelOption()):"rt_gmode"==v?(enableExtChRows(o),insertExtChannelOption(),nmode_limitation(),automode_hint()):"rt_guest_auth_mode_1"==v?(rt_auth_mode_change_guest(0),"psk"==o.value?(document.form.rt_guest_wpa_psk_1.focus(),document.form.rt_guest_wpa_psk_1.select()):"shared"!=o.value&&"radius"!=o.value||(document.form.rt_guest_phrase_x_1.focus(),document.form.rt_guest_phrase_x_1.select())):"rt_guest_wep_x_1"==v?change_wlweptype_guest(o,"WLANConfig11b"):"rt_guest_crypto_1"==v&&rt_auth_mode_change_guest(0);return!0}function change_wlweptype(e,t,r){"0"==e.value?(wflag=0,wep="",document.form.rt_key1.value=wep,document.form.rt_key2.value=wep,document.form.rt_key3.value=wep,document.form.rt_key4.value=wep):(wflag=1,document.form.rt_phrase_x.value.length>0&&0==r&&is_wlphrase("WLANConfig11b","rt_phrase_x",document.form.rt_phrase_x)),inputCtrl(document.form.rt_phrase_x,wflag),inputCtrl(document.form.rt_key1,wflag),inputCtrl(document.form.rt_key2,wflag),inputCtrl(document.form.rt_key3,wflag),inputCtrl(document.form.rt_key4,wflag),inputCtrl(document.form.rt_key,wflag),rt_wep_change()}function change_wlkey(e,t){return"Advanced_WirelessGuest_Content.asp"==document.form.current_page.value?wep=document.form.rt_guest_wep_x_1.value:wep=document.form.rt_wep_x.value,"1"==wep?e.value.length>10&&(e.value=e.value.substring(0,10)):"2"==wep&&e.value.length>26&&(e.value=e.value.substring(0,26)),!0}function changeWEPType(){"0"==document.form.rt_wep.value?flag=0:flag=1,inputCtrl(document.form.rt_phrase_x,flag),inputCtrl(document.form.rt_key1,flag),inputCtrl(document.form.rt_key2,flag),inputCtrl(document.form.rt_key3,flag),inputCtrl(document.form.rt_key4,flag),inputCtrl(document.form.rt_key,flag)}function changeAuthType(){"shared"==document.form.rt_auth_mode.value?(inputCtrl(document.form.rt_crypto,0),inputCtrl(document.form.rt_wpa_psk,0),inputCtrl(document.form.rt_wep,1),inputCtrl(document.form.rt_phrase_x,1),inputCtrl(document.form.rt_key1,1),inputCtrl(document.form.rt_key2,1),inputCtrl(document.form.rt_key3,1),inputCtrl(document.form.rt_key4,1),inputCtrl(document.form.rt_key,1),inputCtrl(document.form.rt_wpa_gtk_rekey,0)):"psk"==document.form.rt_auth_mode.value?(inputCtrl(document.form.rt_crypto,1),inputCtrl(document.form.rt_wpa_psk,1),inputCtrl(document.form.rt_wep,1),inputCtrl(document.form.rt_phrase_x,1),inputCtrl(document.form.rt_key1,1),inputCtrl(document.form.rt_key2,1),inputCtrl(document.form.rt_key3,1),inputCtrl(document.form.rt_key4,1),inputCtrl(document.form.rt_key,1),inputCtrl(document.form.rt_wpa_gtk_rekey,0)):"wpa"==document.form.rt_auth_mode.value?(inputCtrl(document.form.rt_crypto,0),inputCtrl(document.form.rt_wpa_psk,0),inputCtrl(document.form.rt_wep,0),inputCtrl(document.form.rt_phrase_x,0),inputCtrl(document.form.rt_key1,0),inputCtrl(document.form.rt_key2,0),inputCtrl(document.form.rt_key3,0),inputCtrl(document.form.rt_key4,0),inputCtrl(document.form.rt_key,0),inputCtrl(document.form.rt_wpa_gtk_rekey,0)):"radius"==document.form.rt_auth_mode.value?(inputCtrl(document.form.rt_crypto,1),inputCtrl(document.form.rt_wpa_psk,1),inputCtrl(document.form.rt_wep,1),inputCtrl(document.form.rt_phrase_x,1),inputCtrl(document.form.rt_key1,1),inputCtrl(document.form.rt_key2,1),inputCtrl(document.form.rt_key3,1),inputCtrl(document.form.rt_key4,1),inputCtrl(document.form.rt_key,1),inputCtrl(document.form.rt_wpa_gtk_rekey,0)):(inputCtrl(document.form.rt_crypto,0),inputCtrl(document.form.rt_wpa_psk,0),inputCtrl(document.form.rt_wep,1),inputCtrl(document.form.rt_phrase_x,1),inputCtrl(document.form.rt_key1,1),inputCtrl(document.form.rt_key1,1),inputCtrl(document.form.rt_key1,1),inputCtrl(document.form.rt_key1,1),inputCtrl(document.form.rt_key1,1),inputCtrl(document.form.rt_key,1),inputCtrl(document.form.rt_wpa_gtk_rekey,0))}function is_wlphrase(e,t,r){var o=new Array,n=new Array(5);if("rt_wpa_psk"==t)return valid_WPAPSK(r);if("Advanced_WirelessGuest_Content.asp"==document.form.current_page.value?(wepType=document.form.rt_guest_wep_x_1.value,wepKey1=document.form.rt_guest_key1_1,wepKey2=document.form.rt_guest_key2_1,wepKey3=document.form.rt_guest_key3_1,wepKey4=document.form.rt_guest_key4_1):(wepType=document.form.rt_wep_x.value,wepKey1=document.form.rt_key1,wepKey2=document.form.rt_key2,wepKey3=document.form.rt_key3,wepKey4=document.form.rt_key4),phrase=r.value,"1"==wepType){for(var m=0;m<phrase.length;m++)o[m%4]^=phrase.charCodeAt(m);randNumber=o[0]|o[1]<<8|o[2]<<16|o[3]<<24;for(var u=0;u<5;u++)randNumber=214013*randNumber%16777216,randNumber=(randNumber+2531011)%16777216,n[u]=randNumber>>16&255;wepKey1.value=binl2hex_c(n);for(u=0;u<5;u++)randNumber=214013*randNumber%16777216,randNumber=(randNumber+2531011)%16777216,n[u]=randNumber>>16&255;wepKey2.value=binl2hex_c(n);for(u=0;u<5;u++)randNumber=214013*randNumber%16777216,randNumber=(randNumber+2531011)%16777216,n[u]=randNumber>>16&255;wepKey3.value=binl2hex_c(n);for(u=0;u<5;u++)randNumber=214013*randNumber%16777216,randNumber=(randNumber+2531011)%16777216,n[u]=randNumber>>16&255;wepKey4.value=binl2hex_c(n)}else if("2"==wepType||"3"==wepType){if(password="",phrase.length>0)for(m=0;m<64;m++)ch=phrase.charAt(m%phrase.length),password+=ch;password=calcMD5(password),"2"==wepType?wepKey1.value=password.substr(0,26):wepKey1.value=password.substr(0,32),wepKey2.value=wepKey1.value,wepKey3.value=wepKey1.value,wepKey4.value=wepKey1.value}return!0}function rt_wep_change(){var e=document.form.rt_auth_mode.value,t=document.form.rt_wep_x.value;"psk"==e||"wpa"==e||"wpa2"==e?("wpa"!=e&&"wpa2"!=e&&(inputCtrl(document.form.rt_crypto,1),inputCtrl(document.form.rt_wpa_psk,1)),inputCtrl(document.form.rt_wpa_gtk_rekey,1),inputCtrl(document.form.rt_wep_x,0),inputCtrl(document.form.rt_phrase_x,0),inputCtrl(document.form.rt_key1,0),inputCtrl(document.form.rt_key2,0),inputCtrl(document.form.rt_key3,0),inputCtrl(document.form.rt_key4,0),inputCtrl(document.form.rt_key,0),$("row_wpa3").style.display="",$("row_wep1").style.display="none",$("row_wep2").style.display="none",$("row_wep3").style.display="none",$("row_wep4").style.display="none",$("row_wep5").style.display="none",$("row_wep6").style.display="none",$("row_wep7").style.display="none"):"radius"==e?(inputCtrl(document.form.rt_crypto,0),inputCtrl(document.form.rt_wpa_psk,0),inputCtrl(document.form.rt_wpa_gtk_rekey,0),inputCtrl(document.form.rt_wep_x,0),inputCtrl(document.form.rt_phrase_x,0),inputCtrl(document.form.rt_key1,0),inputCtrl(document.form.rt_key2,0),inputCtrl(document.form.rt_key3,0),inputCtrl(document.form.rt_key4,0),inputCtrl(document.form.rt_key,0),$("row_wpa3").style.display="none",$("row_wep1").style.display="none",$("row_wep2").style.display="none",$("row_wep3").style.display="none",$("row_wep4").style.display="none",$("row_wep5").style.display="none",$("row_wep6").style.display="none",$("row_wep7").style.display="none"):(inputCtrl(document.form.rt_crypto,0),inputCtrl(document.form.rt_wpa_psk,0),inputCtrl(document.form.rt_wpa_gtk_rekey,0),inputCtrl(document.form.rt_wep_x,1),$("row_wpa3").style.display="none",$("row_wep1").style.display="","0"!=t?(inputCtrl(document.form.rt_phrase_x,1),inputCtrl(document.form.rt_key1,1),inputCtrl(document.form.rt_key2,1),inputCtrl(document.form.rt_key3,1),inputCtrl(document.form.rt_key4,1),inputCtrl(document.form.rt_key,1),$("row_wep2").style.display="",$("row_wep3").style.display="",$("row_wep4").style.display="",$("row_wep5").style.display="",$("row_wep6").style.display="",$("row_wep7").style.display=""):(inputCtrl(document.form.rt_phrase_x,0),inputCtrl(document.form.rt_key1,0),inputCtrl(document.form.rt_key2,0),inputCtrl(document.form.rt_key3,0),inputCtrl(document.form.rt_key4,0),inputCtrl(document.form.rt_key,0),$("row_wep2").style.display="none",$("row_wep3").style.display="none",$("row_wep4").style.display="none",$("row_wep5").style.display="none",$("row_wep6").style.display="none",$("row_wep7").style.display="none")),change_key_des()}function change_wep_type(e,t){var r,o,n=document.form.rt_wep_x.value;free_options(document.form.rt_wep_x),"shared"==e?(r=new Array("WEP-64bits","WEP-128bits"),o=new Array("1","2")):(r=new Array("None","WEP-64bits","WEP-128bits"),o=new Array("0","1","2")),add_options_x2(document.form.rt_wep_x,r,o,n),"psk"!=e&&"wpa"!=e&&"wpa2"!=e&&"radius"!=e||(document.form.rt_wep_x.value="0"),change_wlweptype(document.form.rt_wep_x,"WLANConfig11b",t)}function enableExtChRows(e){"1"==e.value||"2"==e.value?$("row_protect").style.display="":$("row_protect").style.display="none","0"==e.value||"1"==e.value||"4"==e.value?($("row_HT_BW").style.display="none",$("row_HT_EXTCHA").style.display="none"):($("row_HT_BW").style.display="",$("row_HT_EXTCHA").style.display="")}function insertChannelOption(){var e,t=document.form.rt_country_code.value,r=document.form.rt_channel.value;free_options(document.form.rt_channel),e=new Array(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14),"CA"==t||"CO"==t||"DO"==t||"GT"==t||"MX"==t||"NO"==t||"PA"==t||"PR"==t||"TW"==t||"US"==t||"UZ"==t?e.splice(12,3):"DB"!=t&&e.splice(14,1);for(var o=new Array,n=0;n<e.length;n++)o[n]=e[n];"0"==o[0]&&(e[0]="<#APChnAuto#>"),add_options_x2(document.form.rt_channel,e,o,r)}function insertExtChannelOption(){var e=document.form.rt_gmode.value,t=document.form.rt_channel.value,r=document.form.rt_channel.options.length;if("2"!=e&&"3"!=e&&"5"!=e&&"6"!=e||"0"==document.form.rt_HT_BW.value)inputCtrl(document.form.rt_HT_EXTCHA,0);else{inputCtrl(document.form.rt_HT_EXTCHA,1);var o=document.form.rt_HT_EXTCHA;document.form.rt_HT_EXTCHA.options.length>1&&(o.selectedIndex=1,o.remove(o.selectedIndex)),t>=1&&t<=4?(o.options[0].text=1*t+4,o.options[0].value=1):t>=5&&t<=7?(o.options[0].text=1*t-4,o.options[0].value=0,t*=1,t+=4,add_a_option(document.form.rt_HT_EXTCHA,1,t),1==document.form.rt_HT_EXTCHA_old.value&&(document.form.rt_HT_EXTCHA.options.selectedIndex=1)):t>=8&&t<=9?(o.options[0].text=1*t-4,o.options[0].value=0,r>=14&&(t*=1,t+=4,add_a_option(document.form.rt_HT_EXTCHA,1,t),1==document.form.rt_HT_EXTCHA_old.value&&(document.form.rt_HT_EXTCHA.options.selectedIndex=1))):10==t?(o.options[0].text=1*t-4,o.options[0].value=0,r>14&&(t*=1,t+=4,add_a_option(document.form.rt_HT_EXTCHA,1,t),1==document.form.rt_HT_EXTCHA_old.value&&(document.form.rt_HT_EXTCHA.options.selectedIndex=1))):t>=11?(o.options[0].text=1*t-4,o.options[0].value=0):(o.options[0].text="<#APChnBelow#>",o.options[0].value="0",add_a_option(document.form.rt_HT_EXTCHA,1,"<#APChnAbove#>"),1==document.form.rt_HT_EXTCHA_old.value&&(document.form.rt_HT_EXTCHA.options.selectedIndex=1))}}function rt_auth_mode_change(e){var t,r,o=document.form.rt_auth_mode.value;if(inputCtrl(document.form.rt_wep_x,1),"wpa"==o||"wpa2"==o||"psk"==o?(inputCtrl(document.form.rt_crypto,1),$("row_wpa1").style.display=""):(inputCtrl(document.form.rt_crypto,0),$("row_wpa1").style.display="none"),"psk"==o?(inputCtrl(document.form.rt_wpa_psk,1),$("row_wpa2").style.display=""):(inputCtrl(document.form.rt_wpa_psk,0),$("row_wpa2").style.display="none"),"psk"==o){for(var n=0;n<document.form.rt_crypto.length;n++)if(document.form.rt_crypto[n].selected){t=document.form.rt_crypto[n].value;break}for(var n in opts=document.form.rt_auth_mode.options,r="WPA-Personal"==opts[opts.selectedIndex].text?new Array("TKIP"):"WPA2-Personal"==opts[opts.selectedIndex].text?new Array("AES"):new Array("AES","TKIP+AES"),document.form.rt_crypto.length=r.length,r)document.form.rt_crypto[n]=new Option(r[n],r[n].toLowerCase()),document.form.rt_crypto[n].value=r[n].toLowerCase(),r[n].toLowerCase()==t&&(document.form.rt_crypto[n].selected=!0)}else if("wpa"==o){for(n=0;n<document.form.rt_crypto.length;n++)if(document.form.rt_crypto[n].selected){t=document.form.rt_crypto[n].value;break}for(var n in opts=document.form.rt_auth_mode.options,r="WPA-Enterprise"==opts[opts.selectedIndex].text?new Array("TKIP"):new Array("AES","TKIP+AES"),document.form.rt_crypto.length=r.length,r)document.form.rt_crypto[n]=new Option(r[n],r[n].toLowerCase()),document.form.rt_crypto[n].value=r[n].toLowerCase(),r[n].toLowerCase()==t&&(document.form.rt_crypto[n].selected=!0)}else if("wpa2"==o){for(n=0;n<document.form.rt_crypto.length;n++)if(document.form.rt_crypto[n].selected){t=document.form.rt_crypto[n].value;break}for(var n in r=new Array("AES"),document.form.rt_crypto.length=r.length,r)document.form.rt_crypto[n]=new Option(r[n],r[n].toLowerCase()),document.form.rt_crypto[n].value=r[n].toLowerCase(),r[n].toLowerCase()==t&&(document.form.rt_crypto[n].selected=!0)}change_wep_type(o,e);for(n=0;n<document.form.rt_key.length;n++)if(document.form.rt_key[n].selected){t=document.form.rt_key[n].value;break}for(var n in"wpa"==o||"wpa2"==o||"psk"==o||"radius"==o?r=new Array("2","3"):(r=new Array("1","2","3","4"),e||(t="1")),document.form.rt_key.length=r.length,r)document.form.rt_key[n]=new Option(r[n],r[n]),document.form.rt_key[n].value=r[n],r[n]==t&&(document.form.rt_key[n].selected=!0);rt_wep_change()}function validate_wlkey(e){var t=document.form.rt_wep_x.value,r=!0,o="<#JS_wepkey#>";return"0"==t?r=!0:"1"==t?5==e.value.length&&validate_string(e)?(document.form.rt_key_type.value=1,r=!0):10==e.value.length&&validate_hex(e)?(document.form.rt_key_type.value=0,r=!0):(o+="(<#WLANConfig11b_WEPKey_itemtype1#>)",r=!1):"2"==t?13==e.value.length&&validate_string(e)?(document.form.rt_key_type.value=1,r=!0):26==e.value.length&&validate_hex(e)?(document.form.rt_key_type.value=0,r=!0):(o+="(<#WLANConfig11b_WEPKey_itemtype2#>)",r=!1):(alert("System error!"),r=!1),0==r&&(alert(o),e.focus(),e.select()),r}